-- 1. Checked the internal structure (i.e., data types) of data frames

# Encounters
SELECT * 
FROM public.encounters
--> Timestamp data type columns ('Start' and 'Stop') were designated as 'date' and 'time' data types for further analysis of date/time.
--> Character type data within the 'Code' column required conversion into integer type data. 

# Patients
SELECT * 
FROM public.patients
--> No data types required cleansing.

# Immunizations
SELECT * 
FROM public.immunizations
--> The Timestamp data type column ('date') requires converting to 'date' and 'time' data types for further analysis of date/time.

# Conditions
SELECT * 
FROM public.conditions
--> No data types required cleansing. 

-- 2. Added columns converting the data types that required cleansing

# Encounters 
SELECT *,
CAST(start AS DATE) as start_date,
CAST(start AS TIME) as start_time,
CAST(stop AS DATE) as stop_date,
CAST(stop AS TIME) as stop_time,
CAST(code AS INT)
FROM public.encounters

# Immunizations
SELECT *,
CAST(date AS DATE) as date,
CAST(date AS TIME) as time
FROM public.immunizations

-- 3. Checked for duplicates within datasets

SELECT id, COUNT(*)
FROM public.encounters
GROUP BY id
HAVING COUNT(*) > 1

SELECT id, COUNT(*)
FROM public.patients
GROUP BY id
HAVING COUNT(*) > 1

SELECT patient, COUNT(*)
FROM public.immunizations
GROUP BY patient
HAVING COUNT(*) > 1

SELECT patient, COUNT(*)
FROM public.conditions
GROUP BY patient
HAVING COUNT(*) > 1

--> No duplicates were present in the 'patient' or 'encounters' data frames.
--> Both the 'immunizations' and 'conditions' data frames had a range of patients that had encountered the hospital many times. 
--> However, no duplicates were removed, as each 'patient' had encountered the hospital for diverse immunizations and conditions. 
--> This was cross-checked with the DISTINCT function:

SELECT DISTINCT *
FROM public.conditions

SELECT DISTINCT *
FROM public.immunizations


